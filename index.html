<!DOCTYPE html>
<html lang="es">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <main class="main-container">

      <div class="custom-control w">
        <input type="checkbox" id="100" class="custom-control-input 100#0">
        <label for="100" class="custom-control-label">Este es un padre</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="101" class="custom-control-input 101#100">
        <label for="101" class="custom-control-label">Este es un hijo numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="102" class="custom-control-input 102#101">
        <label for="102" class="custom-control-label">Este es un nieto numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="103" class="custom-control-input 103#100">
        <label for="103" class="custom-control-label">Este es un hijo numero 2</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="104" class="custom-control-input 104#103">
        <label for="104" class="custom-control-label">Este es un nieto numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="105" class="custom-control-input 105#103">
        <label for="105" class="custom-control-label">Este es un nieto numero 2</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="106" class="custom-control-input 106#100">
        <label for="106" class="custom-control-label">Este es un hijo numero 3</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="200" class="custom-control-input 200#0">
        <label for="200" class="custom-control-label">Este es un padre</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="201" class="custom-control-input 201#200">
        <label for="201" class="custom-control-label">Este es un hijo numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="202" class="custom-control-input 202#201">
        <label for="202" class="custom-control-label">Este es un nieto numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="203" class="custom-control-input 203#200">
        <label for="203" class="custom-control-label">Este es un hijo numero 2</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="204" class="custom-control-input 204#203">
        <label for="204" class="custom-control-label">Este es un nieto numero 1</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="205" class="custom-control-input 205#203">
        <label for="205" class="custom-control-label">Este es un nieto numero 2</label>
      </div>

      <div class="custom-control w">
        <input type="checkbox" id="206" class="custom-control-input 206#200">
        <label for="206" class="custom-control-label">Este es un hijo numero 3</label>
      </div>

    </main>

    <!--<script src="functions.js"></script>-->
    <!--<script src="delegacion-de-eventos.js"></script>-->
    <!--<script src="script/new-functions.js" charset="utf-8"></script>
    <script src="script/adding-margin.js" charset="utf-8"></script>-->

    <script type="text/javascript" charset="utf-8">

      const inputs = document.querySelectorAll('input[class*="#"]');
      const inputsPadres = document.querySelectorAll('input[class$="#0"]');

      document.querySelector('.main-container').addEventListener('click',(e)=>{

        if(e.target && e.target.tagName == 'INPUT'){ // verifica si lo clickeado es un input

          let currClass = e.target.classList[(e.target.classList.length - 1)]; //obtiene la clase del input clickeado
          let currInput = {actualID: currClass.split('#')[0]}; // adjunta el id del input clickeado

          if(e.target.checked){encenderHijos(currInput.actualID);} // si el input esta en checked ejecuta la funcion
          else{apagarHijos(currInput.actualID);} // si no esta en checked, ejecuta la funcion

        }

      });

      //-- FUNCIONES --

      const encenderHijos = (hijosID)=>{

        for(let inp of inputs){ // for en todos los inputs

          let currClass = inp.classList[(inp.classList.length - 1)]; // obtiene la clase del input actual
          let currInput = {actualID: currClass.split('#')[0], parentID: currClass.split('#')[1]}; // adjunta la id del input

          if(hijosID == currInput.parentID){

            inp.disabled = false;
            if(inp.checked){encenderHijos(currInput.actualID);}
            else {apagarHijos(currInput.actualID);continue;};

          } // habilita los inputs hijos actuales si es igual al parametro
          else{continue;} // si no es igual, continua
        }

      };

      const apagarHijos = (hijosID)=>{

        for(let inp of inputs){

          let currClass = inp.classList[(inp.classList.length - 1)];

          let currInput = {

            actualID: currClass.split('#')[0],
            parentID: currClass.split('#')[1]

          };

          if(hijosID == currInput.parentID){

            inp.checked = false;
            inp.disabled = true;
            apagarHijos(currInput.actualID); // vuelve a ejecutar la funcion para que los demas hijos sean dehabilitados

          }
          else{continue;}

        }

      };

      for(let inpPadre of inputsPadres){

        let currClass = inpPadre.classList[(inpPadre.classList.length - 1)];

        let currInput = {actualID: currClass.split('#')[0]};

        if(inpPadre.checked){encenderHijos(currInput.actualID);}
        else{apagarHijos(currInput.actualID);};

      }


    </script>

    <script type="text/javascript" charset="utf-8">

      const marginHijos = (parent,margin) =>{

        for(let inp of inputs){ // for en todos los inputs

          let currClass = inp.classList[(inp.classList.length - 1)]; // obtiene la clase del input actual
          let currInput = {actualID: currClass.split('#')[0], parentID: currClass.split('#')[1]}; // adjunta la id del input

          if(parent == currInput.parentID){

            margin += 1;
            inp.parentElement.style.marginLeft = margin.toString() + 'em';
            marginHijos(currInput.actualID,margin);
            margin -= 1;

          } // le da margin a cada hijo teniendo en cuenta el margin y la dependencia
          else{continue;}
        }

      }

      for(let inpPadre of inputsPadres){

        let currClass = inpPadre.classList[(inpPadre.classList.length - 1)];

        let currInput = {actualID: currClass.split('#')[0]};

        marginHijos(currInput.actualID,0);

      }


    </script>
</body>

</html>
